<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Dashboard Pedidos F8</title>

  <!-- Favicon / PWA (opcional; si no los tienes, puedes dejar solo el .ico) -->
  <link rel="icon" href="icons/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16.png">
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b3d91">

  <!-- Librerías -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <link rel="stylesheet" href="styles.css"/>
</head>
<body>

<header class="app-header">
  <div class="brand">
    <img src="assets/logo.png" alt="Logo" class="logo">
    <div class="titles">
      <h1 class="title">Dashboard de Pedidos</h1>
      <span class="subtitle">Seguimiento F8</span>
    </div>
  </div>
  <div class="actions">
    <button id="btnLogin" class="btn">Acceder</button>
    <button id="btnEditMode" class="btn" disabled>Modo edición: OFF</button>
    <button id="btnRefresh" class="btn">Actualizar</button>
    <a id="btnEditar" class="btn btn-link" target="_blank" rel="noopener" href="edit.html">Editor clásico</a>
  </div>
</header>

<!-- Modal de login -->
<div id="loginBox" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.4); align-items:center; justify-content:center; z-index:9999;">
  <div style="background:#fff; padding:16px; border-radius:8px; min-width:260px; text-align:center">
    <div id="loginBoxBtn"></div>
    <div style="margin-top:8px"><button id="loginClose" style="padding:6px 10px">Cancelar</button></div>
  </div>
</div>

<!-- KPIs (globales) -->
<section id="kpis-compact" class="kpis">
  <div class="kpi"><div>Total</div><strong id="kpi-total">—</strong></div>
  <div class="kpi"><div>Asignado</div><strong id="kpi-asignado">—</strong></div>
  <div class="kpi"><div>Solicitado</div><strong id="kpi-solicitado">—</strong></div>
  <div class="kpi"><div>Reng. Asig.</div><strong id="kpi-reng-asig">—</strong></div>
  <div class="kpi"><div>Reng. Sol.</div><strong id="kpi-reng-sol">—</strong></div>
  <div class="kpi"><div>Urg/Mens</div><strong><span id="kpi-urg">—</span>/<span id="kpi-men">—</span></strong></div>
</section>

<!-- Filtros -->
<section class="filters">
  <select id="fCat"><option value="">Todas las categorías</option></select>
  <select id="fUnidad"><option value="">Todas las unidades</option></select>
  <select id="fTipo"><option value="">Todos los tipos</option></select>
  <select id="fGrupo"><option value="">Todos los grupos</option></select>
  <select id="fEstado"><option value="">Todos los estados</option></select>
  <input id="fBuscar" placeholder="Buscar F8 SALMI / texto…">
  <input id="fDesde" type="date" title="Desde">
  <input id="fHasta" type="date" title="Hasta">
  <button id="btnApply">Aplicar</button>
  <button id="btnClear">Limpiar</button>
</section>

<!-- Gráficos: línea (grande) + dona + barras (compactas a la derecha) -->
<section class="charts">
  <div class="chart chart-line"><canvas id="chart-evol"></canvas></div>
  <div class="chart chart-donut"><canvas id="chart-estado-pastel"></canvas></div>
  <div class="chart chart-bars"><canvas id="chart-estado-grupo"></canvas></div>
</section>

<!-- Tabla -->
<section>
  <div id="kpis"></div>
  <table id="tabla"><thead></thead><tbody></tbody></table>
  <div id="paginacion"></div>
</section>

<!-- Config (ajusta si cambian tus URLs o Client ID) -->
<script>
  window.APP = {
    A_URL: 'https://script.google.com/macros/s/AKfycbx7-NfduLrSsQhcLkXcx4h_IEaxcOj8cLHdPqzJm8bQEWTTfkKcYCfU-imapmHVxtqysg/exec',  // lectura
    B_URL: 'https://script.google.com/macros/s/AKfycbysdeYW1g-l1p6ZOyk9aPaUIdx5H4GbzYFVeD1T8_SsyQoODqo-dSzjQMeu7lZzYmQ/exec',  // escritura
    CLIENT_ID: '63868073848-8bfis5g0f8mt14oia3flmbqksg69tejq.apps.googleusercontent.com'
  };
</script>

<script src="metrics.js"></script>
<script src="app.js"></script>

<!-- Service Worker (opcional PWA) -->
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js', { scope: '/Dashboard_Pedidos_F8/' }).catch(console.error);
  }
</script>
</body>
</html>
